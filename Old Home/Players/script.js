const playersData = [];

// ==============================
// ======= FORWARD PLAYERS =====
// ==============================

playersData.push({
  season: 'career',
  category: 'forwards',
  name: 'Sabbir Rahman',
  number: 10,
  photo: 'images/forward1.jpg',
  video: 'https://www.youtube.com/embed/videoF1',
  stats: {
    Position: 'Forward',
    Appearances: 22,
    Goals: 14,
    Assists: 6,
    Interceptions: 3,
    Blocked: 1,
    'Successful Tackle': 2,
    'Yellow Cards': 0,
    'Red Cards': 0,
    MOTM: 3
  }
});

playersData.push({
  season: 'career',
  category: 'forwards',
  name: 'Rakib Hossain',
  number: 9,
  photo: 'images/forward2.jpg',
  video: 'https://www.youtube.com/embed/videoF2',
  stats: {
    Position: 'Forward',
    Appearances: 19,
    Goals: 11,
    Assists: 5,
    Interceptions: 2,
    Blocked: 0,
    'Successful Tackle': 1,
    'Yellow Cards': 1,
    'Red Cards': 0,
    MOTM: 2
  }
});

playersData.push({
  season: 'career',
  category: 'forwards',
  name: 'Ashraful Islam',
  number: 7,
  photo: 'images/forward3.jpg',
  video: 'https://www.youtube.com/embed/videoF3',
  stats: {
    Position: 'Forward',
    Appearances: 20,
    Goals: 9,
    Assists: 7,
    Interceptions: 1,
    Blocked: 1,
    'Successful Tackle': 2,
    'Yellow Cards': 0,
    'Red Cards': 0,
    MOTM: 1
  }
});


// ==============================
// ===== MIDFIELDER PLAYERS =====
// ==============================

playersData.push({
  season: 'career',
  category: 'midfielders',
  name: 'Fahim Khan',
  number: 11,
  photo: 'images/midfielder1.jpg',
  video: 'https://www.youtube.com/embed/videoM1',
  stats: {
    Position: 'Midfielder',
    Appearances: 24,
    Goals: 6,
    Assists: 10,
    Interceptions: 5,
    Blocked: 2,
    'Successful Tackle': 6,
    'Yellow Cards': 1,
    'Red Cards': 0,
    MOTM: 2
  }
});

playersData.push({
  season: 'career',
  category: 'midfielders',
  name: 'Imran Ali',
  number: 8,
  photo: 'images/midfielder2.jpg',
  video: 'https://www.youtube.com/embed/videoM2',
  stats: {
    Position: 'Midfielder',
    Appearances: 20,
    Goals: 5,
    Assists: 8,
    Interceptions: 6,
    Blocked: 1,
    'Successful Tackle': 7,
    'Yellow Cards': 2,
    'Red Cards': 0,
    MOTM: 1
  }
});

playersData.push({
  season: 'career',
  category: 'midfielders',
  name: 'Naim Sheikh',
  number: 6,
  photo: 'images/midfielder3.jpg',
  video: 'https://www.youtube.com/embed/videoM3',
  stats: {
    Position: 'Midfielder',
    Appearances: 18,
    Goals: 3,
    Assists: 9,
    Interceptions: 4,
    Blocked: 2,
    'Successful Tackle': 5,
    'Yellow Cards': 0,
    'Red Cards': 0,
    MOTM: 1
  }
});


// ============================
// ===== DEFENDER PLAYERS ====
// ============================

playersData.push({
  season: 'career',
  category: 'defenders',
  name: 'Shamim Reza',
  number: 4,
  photo: 'images/defender1.jpg',
  video: 'https://www.youtube.com/embed/videoD1',
  stats: {
    Position: 'Defender',
    Appearances: 26,
    Goals: 1,
    Assists: 2,
    Interceptions: 9,
    Blocked: 7,
    'Successful Tackle': 12,
    'Yellow Cards': 1,
    'Red Cards': 0,
    MOTM: 2
  }
});

playersData.push({
  season: 'career',
  category: 'defenders',
  name: 'Hasib Hasan',
  number: 5,
  photo: 'images/defender2.jpg',
  video: 'https://www.youtube.com/embed/videoD2',
  stats: {
    Position: 'Defender',
    Appearances: 23,
    Goals: 2,
    Assists: 1,
    Interceptions: 8,
    Blocked: 6,
    'Successful Tackle': 10,
    'Yellow Cards': 2,
    'Red Cards': 1,
    MOTM: 1
  }
});

playersData.push({
  season: 'career',
  category: 'defenders',
  name: 'Amit Saha',
  number: 3,
  photo: 'images/defender3.jpg',
  video: 'https://www.youtube.com/embed/videoD3',
  stats: {
    Position: 'Defender',
    Appearances: 21,
    Goals: 0,
    Assists: 1,
    Interceptions: 7,
    Blocked: 5,
    'Successful Tackle': 9,
    'Yellow Cards': 1,
    'Red Cards': 0,
    MOTM: 1
  }
});


// ==============================
// ===== GOALKEEPER PLAYERS ====
// ==============================

playersData.push({
  season: 'career',
  category: 'goalkeepers',
  name: 'Morshed Alam',
  number: 1,
  photo: 'images/goalkeeper1.jpg',
  video: 'https://www.youtube.com/embed/videoG1',
  stats: {
    Position: 'Goalkeeper',
    Appearances: 30,
    Goals: 0,
    Assists: 0,
    Interceptions: 5,
    Blocked: 15,
    'Successful Tackle': 6,
    'Yellow Cards': 0,
    'Red Cards': 0,
    MOTM: 3
  }
});

playersData.push({
  season: 'career',
  category: 'goalkeepers',
  name: 'Shahidul Islam',
  number: 99,
  photo: 'images/goalkeeper2.jpg',
  video: 'https://www.youtube.com/embed/videoG2',
  stats: {
    Position: 'Goalkeeper',
    Appearances: 25,
    Goals: 0,
    Assists: 0,
    Interceptions: 4,
    Blocked: 13,
    'Successful Tackle': 4,
    'Yellow Cards': 1,
    'Red Cards': 0,
    MOTM: 2
  }
});

playersData.push({
  season: 'career',
  category: 'goalkeepers',
  name: 'Rafiul Hossain',
  number: 18,
  photo: 'images/goalkeeper3.jpg',
  video: 'https://www.youtube.com/embed/videoG3',
  stats: {
    Position: 'Goalkeeper',
    Appearances: 22,
    Goals: 100,
    Assists: 100,
    Interceptions: 3,
    Blocked: 11,
    'Successful Tackle': 3,
    'Yellow Cards': 0,
    'Red Cards': 0,
    MOTM: 1
  }
});


// =============== FUNCTIONAL CODE ===============

let currentSeason = 'career';
let currentCategory = null; // null means all categories

function calculatePlayerScore(player) {
  const stats = player.stats;
  return (
    stats.Appearances * 1 +
    stats.Goals * 5 +
    stats.Assists * 4 +
    stats.Interceptions * 3 +
    stats.Blocked * 2 +
    stats['Successful Tackle'] * 3 +
    stats.MOTM * 6 -
    stats['Yellow Cards'] * 1 -
    stats['Red Cards'] * 3
  );
}

function selectSeason(season) {
  if (season === 'career') {
    currentSeason = 'career';
    currentCategory = null; // Show all categories by default
    document.getElementById('categorySelector').style.display = 'block';
    document.getElementById('searchContainer').style.display = 'block';
    renderPlayers();
  } else {
    window.location.href = season + '.html';
  }

  document.querySelectorAll('.season-btn').forEach(btn => {
    btn.classList.toggle('active', btn.textContent.toLowerCase().includes(season));
  });

  document.querySelectorAll('.category-btn').forEach(btn => {
    btn.classList.remove('active');
  });
}

function selectCategory(category) {
  currentCategory = category;
  document.querySelectorAll('.category-btn').forEach(btn => {
    btn.classList.toggle('active', btn.dataset.category === category);
  });
  renderPlayers();
}

function renderPlayers() {
  const container = document.getElementById('playersContainer');
  container.innerHTML = '';

  const searchText = document.getElementById('searchInput')?.value.toLowerCase() || '';

  const filteredPlayers = playersData
    .filter(p =>
      p.season === currentSeason &&
      (!currentCategory || p.category === currentCategory) &&
      p.name.toLowerCase().includes(searchText)
    )
    .sort((a, b) => calculatePlayerScore(b) - calculatePlayerScore(a));

  if (filteredPlayers.length === 0) {
    container.innerHTML = '<p style="text-align:center; color:#888;">No players found.</p>';
    return;
  }

  filteredPlayers.forEach(player => {
    const card = document.createElement('div');
    card.className = 'player-card';

    card.innerHTML = `
      <img src="${player.photo}" alt="${player.name}" class="player-img" onclick="playVideo('${player.video}')"/>
      <div class="player-name">${player.name}</div>
      <div class="jersey-number"><strong>${player.number}</strong></div>
      <div class="stats">
        ${Object.entries(player.stats).map(([key, val], idx) =>
          `<div class="stat" style="background-color: var(--stat-color-${(idx % 10) + 1});"><span>${key}</span><span>${val}</span></div>`
        ).join('')}
      </div>
    `;
    container.appendChild(card);
  });
}

function searchPlayers() {
  renderPlayers();
}

function playVideo(videoUrl) {
  const modal = document.getElementById('videoModal');
  const iframe = document.getElementById('videoFrame');
  iframe.src = videoUrl + '?autoplay=1';
  modal.style.display = 'flex';
}

function closeVideo() {
  const modal = document.getElementById('videoModal');
  const iframe = document.getElementById('videoFrame');
  iframe.src = '';
  modal.style.display = 'none';
}

// Stat colors
const styleSheet = document.styleSheets[0];
const statColors = [
  '#f44336', '#2196f3', '#4caf50', '#ff9800', '#9c27b0',
  '#009688', '#3f51b5', '#ffc107', '#b71c1c', '#673ab7'
];
statColors.forEach((color, idx) => {
  styleSheet.insertRule(`:root { --stat-color-${idx + 1}: ${color}; }`, styleSheet.cssRules.length);
});

// Initial load
selectSeason('career');